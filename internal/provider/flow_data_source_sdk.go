// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package provider

import (
	"context"
	"encoding/json"
	"github.com/epilot-dev/terraform-provider-epilot-automation/internal/provider/typeconvert"
	tfTypes "github.com/epilot-dev/terraform-provider-epilot-automation/internal/provider/types"
	"github.com/epilot-dev/terraform-provider-epilot-automation/internal/sdk/models/operations"
	"github.com/epilot-dev/terraform-provider-epilot-automation/internal/sdk/models/shared"
	"github.com/hashicorp/terraform-plugin-framework-jsontypes/jsontypes"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"
)

func (r *FlowDataSourceModel) RefreshFromSharedAutomationFlow(ctx context.Context, resp *shared.AutomationFlow) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		if resp.Manifest != nil {
			r.Manifest = make([]types.String, 0, len(resp.Manifest))
			for _, v := range resp.Manifest {
				r.Manifest = append(r.Manifest, types.StringValue(v))
			}
		}
		r.Actions = make([]jsontypes.Normalized, 0, len(resp.Actions))
		for _, actionsItem := range resp.Actions {
			var actions jsontypes.Normalized

			actionsResult, _ := json.Marshal(actionsItem)
			actions = jsontypes.NewNormalizedValue(string(actionsResult))

			r.Actions = append(r.Actions, actions)
		}
		if resp.Conditions == nil {
			r.Conditions = jsontypes.NewNormalizedNull()
		} else {
			conditionsResult, _ := json.Marshal(resp.Conditions)
			r.Conditions = jsontypes.NewNormalizedValue(string(conditionsResult))
		}
		if resp.DisableDetails == nil {
			r.DisableDetails = nil
		} else {
			r.DisableDetails = &tfTypes.DisableDetails{}
			r.DisableDetails.Blame = types.StringPointerValue(resp.DisableDetails.Blame)
			r.DisableDetails.DisabledAt = types.StringValue(typeconvert.TimeToString(resp.DisableDetails.DisabledAt))
			r.DisableDetails.DisabledBy = types.StringValue(string(resp.DisableDetails.DisabledBy))
		}
		r.Enabled = types.BoolPointerValue(resp.Enabled)
		r.EntitySchema = types.StringPointerValue(resp.EntitySchema)
		r.FlowName = types.StringValue(resp.FlowName)
		r.ID = types.StringPointerValue(resp.ID)
		if resp.MaxExecutions == nil {
			r.MaxExecutions = nil
		} else {
			r.MaxExecutions = &tfTypes.MaxExecutions{}
			r.MaxExecutions.Count = types.Float64PointerValue(resp.MaxExecutions.Count)
			r.MaxExecutions.Window = types.StringPointerValue(resp.MaxExecutions.Window)
		}
		if resp.Schedules == nil {
			r.Schedules = jsontypes.NewNormalizedNull()
		} else {
			schedulesResult, _ := json.Marshal(resp.Schedules)
			r.Schedules = jsontypes.NewNormalizedValue(string(schedulesResult))
		}
		r.SystemFlow = types.BoolPointerValue(resp.SystemFlow)
		r.TriggerConditions = make([]jsontypes.Normalized, 0, len(resp.TriggerConditions))
		for _, triggerConditionsItem := range resp.TriggerConditions {
			var triggerConditions jsontypes.Normalized

			triggerConditionsResult, _ := json.Marshal(triggerConditionsItem)
			triggerConditions = jsontypes.NewNormalizedValue(string(triggerConditionsResult))

			r.TriggerConditions = append(r.TriggerConditions, triggerConditions)
		}
		r.Triggers = []tfTypes.AnyTrigger{}

		for _, triggersItem := range resp.Triggers {
			var triggers tfTypes.AnyTrigger

			if triggersItem.Any != nil {
				anyResult, _ := json.Marshal(triggersItem.Any)
				triggers.Any = jsontypes.NewNormalizedValue(string(anyResult))
			}
			if triggersItem.APISubmissionTrigger != nil {
				triggers.APISubmissionTrigger = &tfTypes.APISubmissionTrigger{}
				triggers.APISubmissionTrigger.Configuration.SourceID = types.StringPointerValue(triggersItem.APISubmissionTrigger.Configuration.SourceID)
				triggers.APISubmissionTrigger.ID = types.StringPointerValue(triggersItem.APISubmissionTrigger.ID)
				triggers.APISubmissionTrigger.Type = types.StringValue(string(triggersItem.APISubmissionTrigger.Type))
			}
			if triggersItem.EntityManualTrigger != nil {
				triggers.EntityManualTrigger = &tfTypes.EntityManualTrigger{}
				triggers.EntityManualTrigger.Configuration.Schema = types.StringPointerValue(triggersItem.EntityManualTrigger.Configuration.Schema)
				triggers.EntityManualTrigger.ID = types.StringPointerValue(triggersItem.EntityManualTrigger.ID)
				triggers.EntityManualTrigger.Type = types.StringValue(string(triggersItem.EntityManualTrigger.Type))
			}
			if triggersItem.EntityOperationTrigger != nil {
				triggers.EntityOperationTrigger = &tfTypes.EntityOperationTrigger{}
				if triggersItem.EntityOperationTrigger.Configuration.EcpConfig == nil {
					triggers.EntityOperationTrigger.Configuration.EcpConfig = nil
				} else {
					triggers.EntityOperationTrigger.Configuration.EcpConfig = &tfTypes.EcpConfig{}
					if triggersItem.EntityOperationTrigger.Configuration.EcpConfig.FileConfig == nil {
						triggers.EntityOperationTrigger.Configuration.EcpConfig.FileConfig = nil
					} else {
						triggers.EntityOperationTrigger.Configuration.EcpConfig.FileConfig = &tfTypes.FileConfig{}
						triggers.EntityOperationTrigger.Configuration.EcpConfig.FileConfig.SharedWithEndCustomer = types.BoolPointerValue(triggersItem.EntityOperationTrigger.Configuration.EcpConfig.FileConfig.SharedWithEndCustomer)
					}
					triggers.EntityOperationTrigger.Configuration.EcpConfig.Origin = types.StringPointerValue(triggersItem.EntityOperationTrigger.Configuration.EcpConfig.Origin)
					triggers.EntityOperationTrigger.Configuration.EcpConfig.PortalID = types.StringPointerValue(triggersItem.EntityOperationTrigger.Configuration.EcpConfig.PortalID)
				}
				triggers.EntityOperationTrigger.Configuration.ExcludeActivities = make([]types.String, 0, len(triggersItem.EntityOperationTrigger.Configuration.ExcludeActivities))
				for _, v := range triggersItem.EntityOperationTrigger.Configuration.ExcludeActivities {
					triggers.EntityOperationTrigger.Configuration.ExcludeActivities = append(triggers.EntityOperationTrigger.Configuration.ExcludeActivities, types.StringValue(v))
				}
				if triggersItem.EntityOperationTrigger.Configuration.FilterConfig == nil {
					triggers.EntityOperationTrigger.Configuration.FilterConfig = nil
				} else {
					triggers.EntityOperationTrigger.Configuration.FilterConfig = &tfTypes.FilterConfig{}
					if triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Activity == nil {
						triggers.EntityOperationTrigger.Configuration.FilterConfig.Activity = nil
					} else {
						triggers.EntityOperationTrigger.Configuration.FilterConfig.Activity = &tfTypes.Activity{}
						triggers.EntityOperationTrigger.Configuration.FilterConfig.Activity.Type = []tfTypes.EntityOperationTriggerSchemasType{}

						for _, typeVarItem := range triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Activity.Type {
							var typeVar tfTypes.EntityOperationTriggerSchemasType

							if typeVarItem.Str != nil {
								typeVar.Str = types.StringPointerValue(typeVarItem.Str)
							}
							if typeVarItem.AnythingButCondition != nil {
								typeVar.AnythingButCondition = &tfTypes.AnythingButCondition{}
								typeVar.AnythingButCondition.AnythingBut = make([]types.String, 0, len(typeVarItem.AnythingButCondition.AnythingBut))
								for _, v := range typeVarItem.AnythingButCondition.AnythingBut {
									typeVar.AnythingButCondition.AnythingBut = append(typeVar.AnythingButCondition.AnythingBut, types.StringValue(v))
								}
							}
							if typeVarItem.EqualsIgnoreCaseCondition != nil {
								typeVar.EqualsIgnoreCaseCondition = &tfTypes.EqualsIgnoreCaseCondition{}
								typeVar.EqualsIgnoreCaseCondition.EqualsIgnoreCase = types.StringPointerValue(typeVarItem.EqualsIgnoreCaseCondition.EqualsIgnoreCase)
							}
							if typeVarItem.ExistsCondition != nil {
								typeVar.ExistsCondition = &tfTypes.ExistsCondition{}
								typeVar.ExistsCondition.Exists = types.BoolPointerValue(typeVarItem.ExistsCondition.Exists)
							}
							if typeVarItem.PrefixCondition != nil {
								typeVar.PrefixCondition = &tfTypes.PrefixCondition{}
								typeVar.PrefixCondition.Prefix = types.StringPointerValue(typeVarItem.PrefixCondition.Prefix)
							}
							if typeVarItem.SuffixCondition != nil {
								typeVar.SuffixCondition = &tfTypes.SuffixCondition{}
								typeVar.SuffixCondition.Suffix = types.StringPointerValue(typeVarItem.SuffixCondition.Suffix)
							}
							if typeVarItem.WildcardCondition != nil {
								typeVar.WildcardCondition = &tfTypes.WildcardCondition{}
								typeVar.WildcardCondition.Wildcard = types.StringPointerValue(typeVarItem.WildcardCondition.Wildcard)
							}

							triggers.EntityOperationTrigger.Configuration.FilterConfig.Activity.Type = append(triggers.EntityOperationTrigger.Configuration.FilterConfig.Activity.Type, typeVar)
						}
					}
					if triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Operation == nil {
						triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation = nil
					} else {
						triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation = &tfTypes.EntityOperationTriggerOperation{}
						if triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Operation.Diff == nil {
							triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation.Diff = jsontypes.NewNormalizedNull()
						} else {
							diffResult, _ := json.Marshal(triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Operation.Diff)
							triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation.Diff = jsontypes.NewNormalizedValue(string(diffResult))
						}
						triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation.Operation = make([]types.String, 0, len(triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Operation.Operation))
						for _, v := range triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Operation.Operation {
							triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation.Operation = append(triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation.Operation, types.StringValue(string(v)))
						}
						if triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Operation.Payload == nil {
							triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation.Payload = jsontypes.NewNormalizedNull()
						} else {
							payloadResult, _ := json.Marshal(triggersItem.EntityOperationTrigger.Configuration.FilterConfig.Operation.Payload)
							triggers.EntityOperationTrigger.Configuration.FilterConfig.Operation.Payload = jsontypes.NewNormalizedValue(string(payloadResult))
						}
					}
				}
				triggers.EntityOperationTrigger.Configuration.IncludeActivities = make([]types.String, 0, len(triggersItem.EntityOperationTrigger.Configuration.IncludeActivities))
				for _, v := range triggersItem.EntityOperationTrigger.Configuration.IncludeActivities {
					triggers.EntityOperationTrigger.Configuration.IncludeActivities = append(triggers.EntityOperationTrigger.Configuration.IncludeActivities, types.StringValue(v))
				}
				triggers.EntityOperationTrigger.Configuration.Operations = make([]types.String, 0, len(triggersItem.EntityOperationTrigger.Configuration.Operations))
				for _, v := range triggersItem.EntityOperationTrigger.Configuration.Operations {
					triggers.EntityOperationTrigger.Configuration.Operations = append(triggers.EntityOperationTrigger.Configuration.Operations, types.StringValue(string(v)))
				}
				triggers.EntityOperationTrigger.Configuration.Schema = types.StringPointerValue(triggersItem.EntityOperationTrigger.Configuration.Schema)
				triggers.EntityOperationTrigger.ID = types.StringPointerValue(triggersItem.EntityOperationTrigger.ID)
				triggers.EntityOperationTrigger.Type = types.StringValue(string(triggersItem.EntityOperationTrigger.Type))
			}
			if triggersItem.FlowsTrigger != nil {
				triggers.FlowsTrigger = &tfTypes.FlowsTrigger{}
				triggers.FlowsTrigger.Configuration.JourneyID = types.StringPointerValue(triggersItem.FlowsTrigger.Configuration.JourneyID)
				triggers.FlowsTrigger.Configuration.SourceID = types.StringValue(triggersItem.FlowsTrigger.Configuration.SourceID)
				triggers.FlowsTrigger.ID = types.StringPointerValue(triggersItem.FlowsTrigger.ID)
				triggers.FlowsTrigger.Type = types.StringValue(string(triggersItem.FlowsTrigger.Type))
			}
			if triggersItem.FrontendSubmitTrigger != nil {
				triggers.FrontendSubmitTrigger = &tfTypes.APISubmissionTrigger{}
				triggers.FrontendSubmitTrigger.Configuration.SourceID = types.StringPointerValue(triggersItem.FrontendSubmitTrigger.Configuration.SourceID)
				triggers.FrontendSubmitTrigger.ID = types.StringPointerValue(triggersItem.FrontendSubmitTrigger.ID)
				triggers.FrontendSubmitTrigger.Type = types.StringValue(string(triggersItem.FrontendSubmitTrigger.Type))
			}
			if triggersItem.JourneySubmitTrigger != nil {
				triggers.JourneySubmitTrigger = &tfTypes.JourneySubmitTrigger{}
				triggers.JourneySubmitTrigger.Configuration.SourceID = types.StringValue(triggersItem.JourneySubmitTrigger.Configuration.SourceID)
				triggers.JourneySubmitTrigger.ID = types.StringPointerValue(triggersItem.JourneySubmitTrigger.ID)
				triggers.JourneySubmitTrigger.Type = types.StringValue(string(triggersItem.JourneySubmitTrigger.Type))
			}
			if triggersItem.ReceivedEmailTrigger != nil {
				triggers.ReceivedEmailTrigger = &tfTypes.ReceivedEmailTrigger{}
				if triggersItem.ReceivedEmailTrigger.Configuration.MessageType != nil {
					triggers.ReceivedEmailTrigger.Configuration.MessageType = types.StringValue(string(*triggersItem.ReceivedEmailTrigger.Configuration.MessageType))
				} else {
					triggers.ReceivedEmailTrigger.Configuration.MessageType = types.StringNull()
				}
				triggers.ReceivedEmailTrigger.ID = types.StringPointerValue(triggersItem.ReceivedEmailTrigger.ID)
				triggers.ReceivedEmailTrigger.Type = types.StringValue(string(triggersItem.ReceivedEmailTrigger.Type))
			}

			r.Triggers = append(r.Triggers, triggers)
		}
		r.Version = types.Float64PointerValue(resp.Version)
		if resp.WorkflowContext == nil {
			r.WorkflowContext = nil
		} else {
			r.WorkflowContext = &tfTypes.WorkflowContext{}
			r.WorkflowContext.TaskID = types.StringPointerValue(resp.WorkflowContext.TaskID)
			r.WorkflowContext.WorkflowID = types.StringValue(resp.WorkflowContext.WorkflowID)
			r.WorkflowContext.WorkflowRole = types.StringValue(string(resp.WorkflowContext.WorkflowRole))
		}
	}

	return diags
}

func (r *FlowDataSourceModel) ToOperationsGetFlowRequest(ctx context.Context) (*operations.GetFlowRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var flowID string
	flowID = r.ID.ValueString()

	out := operations.GetFlowRequest{
		FlowID: flowID,
	}

	return &out, diags
}
